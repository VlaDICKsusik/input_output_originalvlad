
Для всего этого нужно уметь отличать от прочих ситуацию "рейтинг неизвестен". 
В Python для этих целей предусмотрено значение ```rating = None```. А строку "No 
rating yet" можно переместить туда где данные подготавливаются к выводу в xlsx.

Та же функция, часть вторая, последняя:
```Python
def get_course_info(html):
    # ... more parsing logic is here

    # number prefix is usefull for simple sorting data before output to xlsx
    return {
        '1_title': title,
        '2_date': start_date,
        '3_language': language,
        '4_weeks': duration,
        "5_rating": rating
    }
```
Сразу возникают вопросы. А если нужна еще одна выгрузка в формате csv, с 
другим порядком столбцов, как это сделать? Как заменить столбец ```2_date``` на 
```days_before_start``` ?

Кроме того, наперед известно, что пользовательский интерфейс — будь то вывод в 
консоль или запись в файл — меняется очень часто. Было бы удобно собрать все, 
что относится к форматированию вывода в одном месте. Например, всю логику 
выгрузки в xlsx поместить в ```def fill_xlsx(workbook, courses):```, а вывод в 
консоль собрать внутри``` if __name__=='__main__':```. Удастся избежать вычитывания 
и повторной отладки всей программы от начала до конца, ведь изменения локальны 
и изолированы.

## Вместо заключения


В результате мы пришли к ситуации, когда логика обработки данных слабо зависит:

1. от источника данных;
1. от формата вывода в файл.


![image](https://dvmn.org/filer/canonical/1594117412/678/)

Кроме того, часть кода удалось превратить в [чистые функции](https://devman.org/encyclopedia/decomposition/decomposition_pure_functions/), что облегчит 
тестирование и повторное использование.

Стратегия по отделению операций ввода/вывода от обработки данных встречается 
повсеместно, в самых разных программах: от небольших скриптов до серьезных и 
крупных проектов. Это один из базовых приемов, нужно уверенно им владеть.

